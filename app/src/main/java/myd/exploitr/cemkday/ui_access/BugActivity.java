package myd.exploitr.cemkday.ui_access;

import android.os.Build;
import android.os.Bundle;
import android.widget.CheckBox;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.Toast;

import androidx.appcompat.app.AppCompatActivity;
import androidx.appcompat.widget.SwitchCompat;

import com.google.android.material.floatingactionbutton.FloatingActionButton;
import com.google.firebase.crashlytics.FirebaseCrashlytics;

import myd.exploitr.cemkday.R;

public class BugActivity extends AppCompatActivity {
	
	private EditText bug_;
	private Spinner bug_type_;
	private SwitchCompat multi_seen, rooted;
	private CheckBox privacy_agree;

	protected String getMailText() {
		return "Device : " + Build.DEVICE + "\n" +
						"SDK : " + Build.VERSION.SDK_INT + "\n" +
						"Model : " + Build.MODEL + "\n" +
						"Manufacturer : " + Build.MANUFACTURER + "\n" +
						"Rooted : " + rooted.isChecked() + "\n" +
						"Cyclical : " + multi_seen.isChecked() + "\n" +
						"BUG_MSG : " + bug_.getText().toString() + "\n" +
						"Severity : " + bug_type_.getSelectedItemPosition();
	}
	
	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_bug);
		
		if (getSupportActionBar() != null) {
			getSupportActionBar().setTitle("Submit Bugs/FeaturesÂ±");
		}
		
		bug_ = findViewById(R.id.bug_);
		bug_type_ = findViewById(R.id.bug_type_);
		multi_seen = findViewById(R.id.multi_seen);
		FloatingActionButton submit_bug = findViewById(R.id.submit_bug);
		rooted = findViewById(R.id.rooted);
		privacy_agree = findViewById(R.id.policy_agree);
		
		submit_bug.setOnClickListener(v -> {
					if (privacy_agree.isChecked()) {
						FirebaseCrashlytics.getInstance().recordException(new RuntimeException(getMailText()));
						Toast.makeText(this, "Sent Bug Report!", Toast.LENGTH_SHORT).show();
						finish();
					} else {
						Toast.makeText(this, "Please Accept Privacy Policy", Toast.LENGTH_SHORT).show();
					}
				}
		);
	}

	@Override
	protected void onDestroy() {
		super.onDestroy();
	}
}
